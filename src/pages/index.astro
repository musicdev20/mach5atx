---
import '../styles/globals.css';
import Mach5Header from '../components/Mach5Header.astro';
import SiteFooter from '../components/SiteFooter.astro';
import { getUpcomingShows } from '../lib/shows';
import { ClientRouter } from 'astro:transitions';

export const prerender = false;

const upcomingShows = await getUpcomingShows();
const homepageShows = [...upcomingShows]
    .sort((a, b) => {
        const aTime = new Date(a.startDateTime).getTime();
        const bTime = new Date(b.startDateTime).getTime();
        if (Number.isNaN(aTime) && Number.isNaN(bTime)) return 0;
        if (Number.isNaN(aTime)) return 1;
        if (Number.isNaN(bTime)) return -1;
        return aTime - bTime;
    })
    .slice(0, 3);
const fallbackVenueLogo = '/images/logos/m5logo2.webp';

const showDateFormatter = new Intl.DateTimeFormat('en-US', {
    weekday: 'short',
    month: 'short',
    day: 'numeric',
    hour: 'numeric',
    minute: '2-digit',
    timeZone: 'America/Chicago'
});

const formatShowDate = (dateTime) => showDateFormatter.format(new Date(dateTime));
const liveEnergyImages = [
    { src: '/images/live/lanae1.webp', alt: 'Lead singer performing live on stage' },
    { src: '/images/live/joechuck1.webp', alt: 'Two guitarists performing together on stage' },
    { src: '/images/live/randylive1.jpg', alt: 'Drummer performing live behind a full kit' }
];

const whyMach5Intro =
    'Mach 5 delivers a high-octane rock experience with nonstop momentum, bold stage presence, and crowd-first pacing that keeps dance floors packed.';

const whyMach5Points = [
    'Seamless set flow from first hit to final encore',
    'Big visual energy with pro-level live execution',
    'Built for clubs, festivals, corporate events, and private parties'
];

const contactLinks = {
    email: 'mach5atx@gmail.com',
    facebook: 'https://www.facebook.com/mach5atx/',
    instagram: 'https://www.instagram.com/mach5atx/',
    youtube: 'https://www.youtube.com/@mach5atx'
};
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="Mach 5 - high-energy 70s/80s/90s/00s rock covers in Austin, Texas." />
        <title>Mach 5 | Full-Throttle Rock Covers</title>
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <ClientRouter />
    </head>
    <body class="m5-body">
        <div class="m5-page">
            <div class="m5-bg-video" aria-hidden="true">
                <iframe
                    src="https://www.youtube-nocookie.com/embed/uZjI3LWaCeg?autoplay=1&mute=1&controls=0&loop=1&playlist=uZjI3LWaCeg&modestbranding=1&playsinline=1&rel=0&iv_load_policy=3"
                    title="Mach 5 Sizzle background video"
                    allow="autoplay; encrypted-media; picture-in-picture"
                    referrerpolicy="strict-origin-when-cross-origin"
                    tabindex="-1"
                ></iframe>
            </div>
            <Mach5Header />

            <section class="m5-section m5-connect-strip m5-connect-strip-top m5-shell" aria-label="Connect with Mach 5">
                <div class="m5-connect-links">
                    <a href={contactLinks.facebook} target="_blank" rel="noreferrer" aria-label="Facebook">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M13.5 8.5V6.9c0-.8.5-1.3 1.4-1.3H16V3h-2c-2.3 0-3.8 1.5-3.8 3.9v1.6H8v2.6h2.2V21h3.3v-9.9H16l.4-2.6h-2.9z"></path>
                        </svg>
                    </a>
                    <a href={contactLinks.instagram} target="_blank" rel="noreferrer" aria-label="Instagram">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M7.3 3h9.4A4.3 4.3 0 0 1 21 7.3v9.4a4.3 4.3 0 0 1-4.3 4.3H7.3A4.3 4.3 0 0 1 3 16.7V7.3A4.3 4.3 0 0 1 7.3 3zm0 1.9A2.4 2.4 0 0 0 4.9 7.3v9.4a2.4 2.4 0 0 0 2.4 2.4h9.4a2.4 2.4 0 0 0 2.4-2.4V7.3a2.4 2.4 0 0 0-2.4-2.4H7.3zm9.9 1.4a1.2 1.2 0 1 1 0 2.4 1.2 1.2 0 0 1 0-2.4zM12 7.6a4.4 4.4 0 1 1 0 8.8 4.4 4.4 0 0 1 0-8.8zm0 1.9a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5z"></path>
                        </svg>
                    </a>
                    <a href={contactLinks.youtube} target="_blank" rel="noreferrer" aria-label="YouTube">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M21 8.2c-.2-1.3-1.2-2.2-2.5-2.4C16.6 5.5 14.3 5.4 12 5.4s-4.6.1-6.5.4A2.9 2.9 0 0 0 3 8.2c-.2 1.3-.3 2.5-.3 3.8s.1 2.5.3 3.8c.2 1.3 1.2 2.2 2.5 2.4 1.9.3 4.2.4 6.5.4s4.6-.1 6.5-.4a2.9 2.9 0 0 0 2.5-2.4c.2-1.3.3-2.5.3-3.8s-.1-2.5-.3-3.8zM10 15.5v-7l6 3.5-6 3.5z"></path>
                        </svg>
                    </a>
                    <a href={`mailto:${contactLinks.email}`} aria-label="Email">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M4 5h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2zm0 2 8 5 8-5H4zm0 10h16V9l-8 5-8-5v8z"></path>
                        </svg>
                    </a>
                </div>
            </section>

            <header class="m5-hero">
                <div class="m5-shell">
                    <div class="m5-hero-grid">
                        <div class="m5-hero-copy">
                            <img class="m5-hero-title-art" src="/images/home/full-throttle.png" alt="Full-Throttle Rock That Packs the Dance Floor" loading="eager" decoding="async" />
                            <a class="m5-hero-book-link" href="/book-us" aria-label="Book Us Now">
                                <img class="m5-hero-book-art" src="/images/home/book-us-now.png" alt="Book Us Now" loading="eager" decoding="async" />
                            </a>
                        </div>
                    </div>
                </div>
            </header>

            <main class="m5-content m5-shell">
                <section id="upcoming-shows" class="m5-section">
                    <h2>Upcoming Shows</h2>
                    <div class="m5-show-grid">
                        {
                            homepageShows.map((show) => (
                                <article id={show.id} class="m5-card m5-show-card">
                                    <header class="m5-show-head">
                                        <div class="m5-venue-logo-wrap" aria-hidden="true">
                                            <img src={show.venueLogo || fallbackVenueLogo} alt="" loading="lazy" decoding="async" />
                                        </div>
                                        <div>
                                            <p class="m5-date">
                                                <time datetime={show.startDateTime}>{formatShowDate(show.startDateTime)}</time>
                                            </p>
                                            <h3>{show.eventName}</h3>
                                        </div>
                                    </header>
                                    <p class="m5-show-venue">{show.venueName}</p>
                                    <p class="m5-show-location">{show.venueAddress}</p>
                                    <div class="m5-show-actions">
                                        <a class="m5-show-action" href={show.directionsUrl} target="_blank" rel="noreferrer">Directions</a>
                                        <button
                                            type="button"
                                            class="m5-show-action m5-show-share"
                                            data-id={show.id}
                                            data-event={show.eventName}
                                            data-venue={show.venueName}
                                            data-start={formatShowDate(show.startDateTime)}
                                            data-directions={show.directionsUrl}
                                        >
                                            Share
                                        </button>
                                    </div>
                                </article>
                            ))
                        }
                    </div>
                </section>

                <section id="live-energy" class="m5-section">
                    <h2>Live Energy</h2>
                    <div class="m5-live-grid">
                        {
                            liveEnergyImages.map((image, imageIndex) => (
                                <article class="m5-live-card">
                                    <img src={image.src} alt={image.alt} loading={imageIndex === 0 ? 'eager' : 'lazy'} decoding="async" />
                                </article>
                            ))
                        }
                    </div>
                </section>

                <section id="press-kit" class="m5-section m5-card m5-why-card">
                    <div class="m5-why-layout">
                        <figure class="m5-why-image">
                            <img src="/images/hero/hero3.webp" alt="Mach 5 performing live on stage" loading="lazy" decoding="async" />
                        </figure>
                        <div class="m5-why-copy">
                            <p class="m5-why-intro">{whyMach5Intro}</p>
                            <ul>
                                {whyMach5Points.map((item) => <li>{item}</li>)}
                            </ul>
                            <a href="/press-kit" target="_blank" rel="noopener noreferrer" class="m5-press-btn">
                                Get the Press Kit
                            </a>
                        </div>
                    </div>
                </section>

            </main>
            <SiteFooter />
        </div>
    </body>
</html>

<style>
    @font-face {
        font-family: 'Speedrace Local';
        src: url('/fonts/speedrace.ttf') format('truetype');
        font-display: swap;
    }

    .m5-body {
        margin: 0;
        color: #f5f7fb;
        font-family: 'Inter Variable', ui-sans-serif, system-ui, sans-serif;
        background: #02050f;
    }

    .m5-page {
        position: relative;
        isolation: isolate;
        min-height: 100vh;
        background: rgb(1 3 10 / 65%);
    }

    .m5-bg-video {
        position: fixed;
        inset: 0;
        overflow: hidden;
        pointer-events: none;
        z-index: 0;
    }

    .m5-bg-video iframe {
        position: absolute;
        top: 50%;
        left: 50%;
        width: max(100vw, 177.78vh);
        height: max(56.25vw, 100vh);
        transform: translate(-50%, -50%);
        border: 0;
        opacity: 1;
        filter: saturate(0.9) contrast(0.96) brightness(0.86);
    }

    .m5-page > *:not(.m5-bg-video):not(.m5-top-header) {
        position: relative;
        z-index: 2;
    }

    .m5-page > .m5-top-header {
        position: sticky;
        top: 0;
        z-index: 30;
    }

    @media (prefers-reduced-motion: reduce) {
        .m5-bg-video {
            display: none;
        }

    }

    .m5-shell {
        width: min(1320px, 100% - 3.25rem);
        margin-inline: auto;
    }

    .m5-hero {
        position: relative;
        isolation: isolate;
        padding-bottom: clamp(2.1rem, 4vw, 3.1rem);
        background: transparent;
    }

    .m5-hero-grid {
        display: flex;
        justify-content: center;
        padding-top: clamp(1.8rem, 4vw, 2.8rem);
    }

    .m5-hero-copy {
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: min(980px, 100%);
        align-items: center;
        padding: clamp(0.8rem, 1.2vw, 1.25rem);
    }

    .m5-hero-title-art {
        width: min(100%, 780px);
        height: auto;
        display: block;
        filter: drop-shadow(0 10px 22px rgb(0 0 0 / 68%)) drop-shadow(0 0 24px rgb(255 255 255 / 16%));
    }

    .m5-hero-book-link {
        margin-top: clamp(1.1rem, 2vw, 1.8rem);
        display: inline-flex;
        width: min(100%, 390px);
        justify-content: center;
        text-decoration: none;
    }

    .m5-hero-book-art {
        width: 100%;
        height: auto;
        display: block;
        filter: drop-shadow(0 12px 26px rgb(0 0 0 / 72%)) drop-shadow(0 0 24px rgb(225 6 0 / 30%));
        transition: transform 180ms ease, filter 180ms ease;
    }

    .m5-hero-book-link:hover .m5-hero-book-art {
        transform: translateY(-1px);
        filter: brightness(1.07);
    }

    .m5-content {
        position: relative;
        z-index: 1;
        margin-top: -1.5rem;
        padding-bottom: 4.2rem;
    }

    .m5-section {
        margin-top: 2.9rem;
    }

    .m5-section h2 {
        margin: 0 0 1.35rem;
        font-size: clamp(2.2rem, 1.7rem + 1.6vw, 4rem);
        line-height: 1.1;
        letter-spacing: 0.03em;
        text-transform: uppercase;
        font-family: 'Speedrace Local', 'Impact', 'Arial Black', sans-serif;
    }

    .m5-show-grid {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 1.2rem;
    }

    .m5-card {
        background: linear-gradient(180deg, rgb(11 14 30 / 96%) 0%, rgb(9 12 23 / 94%) 100%);
        border: 1px solid rgb(63 72 101 / 36%);
        border-radius: 1.1rem;
        box-shadow: 0 14px 34px rgb(2 4 12 / 30%);
    }

    .m5-show-card {
        padding: 1.1rem 1.2rem 1.2rem;
        display: flex;
        flex-direction: column;
    }

    .m5-show-head {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 0.8rem;
        align-items: start;
        min-height: 132px;
    }

    .m5-venue-logo-wrap {
        width: 54px;
        height: 54px;
        border-radius: 0.7rem;
        border: 1px solid rgb(255 255 255 / 18%);
        background: rgb(8 11 22 / 90%);
        display: grid;
        place-items: center;
        overflow: hidden;
        color: #f5f7fb;
        font-weight: 800;
        font-size: 1.1rem;
    }

    .m5-venue-logo-wrap img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        background: #060a14;
        padding: 0.18rem;
    }

    .m5-show-card h3 {
        margin: 0.2rem 0 0;
        font-size: clamp(1.28rem, 1.15rem + 0.45vw, 1.65rem);
        line-height: 1.2;
    }

    .m5-show-venue {
        margin: 0.75rem 0 0;
        color: rgb(238 240 247 / 95%);
        font-size: clamp(1.03rem, 0.98rem + 0.2vw, 1.18rem);
        font-weight: 600;
    }

    .m5-show-location {
        margin: 0.3rem 0 0;
        color: rgb(230 233 242 / 78%);
        font-size: clamp(0.98rem, 0.92rem + 0.2vw, 1.1rem);
    }

    .m5-date {
        margin: 0;
        color: #ff2126;
        font-size: clamp(0.95rem, 0.9rem + 0.2vw, 1.05rem);
        font-weight: 700;
        letter-spacing: 0.02em;
    }

    .m5-show-actions {
        margin-top: auto;
        padding-top: 0.9rem;
        display: flex;
        gap: 0.55rem;
    }

    .m5-show-action {
        appearance: none;
        border: 1px solid rgb(255 255 255 / 24%);
        background: rgb(10 14 26 / 75%);
        color: #f5f7fb;
        padding: 0.4rem 0.65rem;
        border-radius: 0.6rem;
        font-size: 0.88rem;
        font-weight: 700;
        text-decoration: none;
        cursor: pointer;
        transition: border-color 160ms ease, color 160ms ease, background-color 160ms ease;
    }

    .m5-show-action:hover {
        border-color: #ff4e56;
        color: #ff4e56;
    }

    .m5-media-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.2rem;
    }

    .m5-media-card {
        position: relative;
        min-height: clamp(220px, 26vw, 340px);
        border-radius: 0.28rem;
        overflow: hidden;
        background: #090f1f;
    }

    .m5-media-card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        filter: saturate(0.95) contrast(1.06);
    }

    .m5-live-grid {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 0.95rem;
    }

    .m5-live-card {
        border-radius: 0.9rem;
        border: 1px solid rgb(255 255 255 / 14%);
        background: linear-gradient(180deg, rgb(9 12 24 / 96%) 0%, rgb(6 9 18 / 96%) 100%);
        box-shadow: 0 14px 30px rgb(3 5 12 / 35%);
        overflow: hidden;
        aspect-ratio: 4 / 3;
        padding: 0.34rem;
    }

    .m5-live-card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        border-radius: 0.62rem;
        background: #050913;
        filter: saturate(0.95) contrast(1.06);
    }

    .m5-media-caption {
        position: absolute;
        inset: auto 0 0;
        background: linear-gradient(180deg, transparent 0%, rgb(4 7 16 / 70%) 38%, rgb(4 7 16 / 92%) 100%);
        padding: 1.3rem 1rem 1.1rem;
    }

    .m5-media-caption h3 {
        margin: 0;
        font-size: clamp(1.45rem, 1.2rem + 0.8vw, 2.25rem);
    }

    .m5-why-card {
        padding: 1.7rem;
    }

    .m5-why-layout {
        display: grid;
        grid-template-columns: minmax(0, 1.05fr) minmax(0, 1.35fr);
        gap: 1.2rem;
        align-items: center;
    }

    .m5-why-image {
        margin: 0;
        border-radius: 0.9rem;
        border: 1px solid rgb(255 255 255 / 15%);
        overflow: hidden;
        background: #060a14;
        aspect-ratio: 4 / 3;
    }

    .m5-why-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
    }

    .m5-why-intro {
        margin: 0 0 0.9rem;
        font-size: clamp(1.12rem, 1rem + 0.4vw, 1.38rem);
        line-height: 1.4;
        color: rgb(233 236 246 / 92%);
    }

    .m5-why-copy ul {
        margin: 0 0 1rem;
        padding-left: 1.25rem;
    }

    .m5-why-copy li {
        margin: 0.4rem 0;
        font-size: clamp(1.2rem, 1.07rem + 0.35vw, 1.58rem);
        color: rgb(233 236 246 / 92%);
    }

    .m5-press-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 0.66rem 1.35rem;
        border-radius: 999px;
        border: 2px solid #ff1118;
        background: rgb(5 8 16 / 92%);
        color: #fff;
        text-decoration: none;
        text-transform: uppercase;
        font-family: 'Speedrace Local', 'Impact', 'Arial Black', sans-serif;
        font-size: 1.02rem;
        letter-spacing: 0.04em;
        line-height: 1;
        white-space: nowrap;
        align-self: start;
        box-shadow: 0 0 0 1px rgb(255 17 24 / 35%), 0 8px 18px rgb(0 0 0 / 30%);
        transition: transform 160ms ease, filter 160ms ease, border-color 160ms ease;
    }

    .m5-press-btn:hover {
        transform: translateY(-1px);
        filter: brightness(1.08);
        border-color: #ff3036;
    }

    .m5-connect-strip {
        margin-top: 2.2rem;
    }

    .m5-connect-strip-top {
        margin-top: 0.6rem;
    }

    .m5-connect-links {
        display: flex;
        justify-content: center;
        gap: 0.7rem;
    }

    .m5-connect-links a {
        text-decoration: none;
        border: 1px solid rgb(255 255 255 / 22%);
        border-radius: 999px;
        background: rgb(10 14 26 / 72%);
        color: rgb(236 240 249 / 95%);
        width: 44px;
        height: 44px;
        display: grid;
        place-items: center;
        line-height: 0;
    }

    .m5-connect-links a svg {
        width: 21px;
        height: 21px;
        fill: currentColor;
    }

    .m5-connect-links a:hover {
        border-color: #ff4e56;
        color: #ff4e56;
        transform: translateY(-1px);
    }

    @media (max-width: 860px) {
        .m5-shell {
            width: min(1200px, 100% - 1.75rem);
        }

        .m5-hero {
            padding-bottom: 1.3rem;
        }

        .m5-hero-grid {
            padding-top: 3.1rem;
        }

        .m5-hero-copy {
            max-width: 100%;
        }

        .m5-hero-title-art {
            width: 100%;
        }

        .m5-hero-book-link {
            margin-top: 0.9rem;
            width: min(100%, 320px);
        }

        .m5-content {
            margin-top: -0.35rem;
            padding-bottom: 2.8rem;
        }

        .m5-section {
            margin-top: 1.7rem;
        }

        .m5-section h2 {
            font-size: clamp(2.2rem, 9.2vw, 3.6rem);
            margin-bottom: 0.9rem;
        }

        .m5-show-grid,
        .m5-media-grid,
        .m5-live-grid {
            grid-template-columns: 1fr;
            gap: 0.9rem;
        }

        .m5-show-card {
            padding: 1.1rem 1.15rem 1.15rem;
        }

        .m5-show-head {
            min-height: 0;
        }

        .m5-show-card h3 {
            font-size: clamp(1.4rem, 5.3vw, 2.1rem);
        }

        .m5-show-venue {
            font-size: clamp(1.15rem, 4.4vw, 1.7rem);
        }

        .m5-show-location {
            font-size: clamp(1rem, 3.8vw, 1.45rem);
            margin-top: 0.2rem;
        }

        .m5-date {
            font-size: clamp(0.95rem, 3.6vw, 1.3rem);
        }

        .m5-venue-logo-wrap {
            width: 52px;
            height: 52px;
        }

        .m5-show-actions {
            margin-top: 0.8rem;
            gap: 0.45rem;
        }

        .m5-show-action {
            font-size: 0.86rem;
            padding: 0.42rem 0.62rem;
        }

        .m5-media-card {
            min-height: 300px;
        }

        .m5-live-card {
            aspect-ratio: 16 / 11;
            padding: 0.26rem;
        }

        .m5-why-card {
            padding: 1.2rem 1rem;
        }

        .m5-why-layout {
            grid-template-columns: 1fr;
            gap: 0.8rem;
        }

        .m5-why-image {
            aspect-ratio: 16 / 10;
        }

        .m5-why-intro {
            font-size: clamp(1.45rem, 4.7vw, 2.1rem);
        }

        .m5-why-copy li {
            font-size: clamp(1.7rem, 5.6vw, 2.6rem);
        }

        .m5-press-btn {
            align-self: stretch;
            padding: 0.7rem 1rem;
        }

        .m5-connect-links {
            gap: 0.55rem;
        }

        .m5-connect-links a {
            width: 40px;
            height: 40px;
        }
    }
</style>

<script is:inline>
    (() => {
        const buttons = Array.from(document.querySelectorAll('.m5-show-share'));
        if (!buttons.length) return;

        const shareShow = async (button) => {
            const id = button.getAttribute('data-id') ?? '';
            const eventName = button.getAttribute('data-event') ?? 'Mach 5 Show';
            const venue = button.getAttribute('data-venue') ?? '';
            const start = button.getAttribute('data-start') ?? '';
            const directions = button.getAttribute('data-directions') ?? '';
            const url = `${window.location.origin}${window.location.pathname}#${id}`;
            const text = `${eventName} at ${venue} on ${start}. Directions: ${directions}`;

            try {
                if (navigator.share) {
                    await navigator.share({ title: `Mach 5 - ${eventName}`, text, url });
                    return;
                }
                if (navigator.clipboard?.writeText) {
                    await navigator.clipboard.writeText(`${text}\n${url}`);
                } else {
                    window.prompt('Copy this show link:', `${text}\n${url}`);
                    return;
                }
                const previous = button.textContent;
                button.textContent = 'Copied';
                window.setTimeout(() => {
                    button.textContent = previous;
                }, 1400);
            } catch {
                // Ignore share cancel/no-op.
            }
        };

        buttons.forEach((button) => {
            button.addEventListener('click', () => {
                shareShow(button);
            });
        });
    })();
</script>
